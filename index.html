<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8">
<title>Mini Chat</title>
</head>
<body>

<h2>ðŸ”¥ Mini Chat</h2>
<div id="chat" style="height:300px;overflow:auto;border:1px solid #555"></div>

<input id="name" placeholder="Nimi">
<input id="msg" placeholder="Viesti">
<button onclick="send()">LÃ¤hetÃ¤</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore, collection, addDoc,
  query, orderBy, onSnapshot, serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDbYLUXJjHQ-V5uFvtyzwq-IwIKM7xTcyc",
  authDomain: "chat-fc8ef.firebaseapp.com",
  projectId: "chat-fc8ef",
  storageBucket: "chat-fc8ef.appspot.com",
  messagingSenderId: "446356718094",
  appId: "1:446356718094:web:f56514352845d6bbb7b25f"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const chat = document.getElementById("chat");

const q = query(collection(db, "messages"), orderBy("time"));
onSnapshot(q, snap => {
  chat.innerHTML = "";
  snap.forEach(d => {
    const m = d.data();
    chat.innerHTML += `<div><b>${m.name}:</b> ${m.text}</div>`;
  });
});

window.send = async () => {
  const name = document.getElementById("name").value || "Anon";
  const text = document.getElementById("msg").value;
  if (!text) return;

  await addDoc(collection(db, "messages"), {
    name,
    text,
    time: serverTimestamp()
  });

  document.getElementById("msg").value = "";
};
</script>

</body>
</html>
